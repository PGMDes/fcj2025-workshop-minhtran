<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=../../images/favicon.png type=image/png><title>Blog 3 :: Internship Report</title>
<link href=../../css/nucleus.css?1765363205 rel=stylesheet><link href=../../css/fontawesome-all.min.css?1765363205 rel=stylesheet><link href=../../css/hybrid.css?1765363205 rel=stylesheet><link href=../../css/featherlight.min.css?1765363205 rel=stylesheet><link href=../../css/perfect-scrollbar.min.css?1765363205 rel=stylesheet><link href=../../css/auto-complete.css?1765363205 rel=stylesheet><link href=../../css/atom-one-dark-reasonable.css?1765363205 rel=stylesheet><link href=../../css/theme.css?1765363205 rel=stylesheet><link href=../../css/hugo-theme.css?1765363205 rel=stylesheet><link href=../../css/theme-workshop.css?1765363205 rel=stylesheet><script src=../../js/jquery-3.3.1.min.js?1765363205></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../3-blogstranslated/3.3-blog3/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../js/lunr.min.js?1765363205></script><script type=text/javascript src=../../js/auto-complete.js?1765363205></script><script type=text/javascript>var baseurl="https://pgmdes.github.io/fcj2025-workshop-minhtran/"</script><script type=text/javascript src=../../js/search.js?1765363205></script></div><div class=highlightable><ul class=topics><li data-nav-id=/1-worklog/ title=Worklog class=dd-item><a href=../../1-worklog/><b>1. </b>Worklog
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/1-worklog/1.1-week1/ title="Week 1 Worklog" class=dd-item><a href=../../1-worklog/1.1-week1/><b>1.1. </b>Week 1 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.2-week2/ title="Week 2 Worklog" class=dd-item><a href=../../1-worklog/1.2-week2/><b>1.2. </b>Week 2 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.3-week3/ title="Week 3 Worklog" class=dd-item><a href=../../1-worklog/1.3-week3/><b>1.3. </b>Week 3 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.4-week4/ title="Week 4 Worklog" class=dd-item><a href=../../1-worklog/1.4-week4/><b>1.4. </b>Week 4 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.5-week5/ title="Week 5 Worklog" class=dd-item><a href=../../1-worklog/1.5-week5/><b>1.5. </b>Week 5 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.6-week6/ title="Week 6 Worklog" class=dd-item><a href=../../1-worklog/1.6-week6/><b>1.6. </b>Week 6 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.7-week7/ title="Week 7 Worklog" class=dd-item><a href=../../1-worklog/1.7-week7/><b>1.7. </b>Week 7 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.8-week8/ title="Week 8 Worklog" class=dd-item><a href=../../1-worklog/1.8-week8/><b>1.8. </b>Week 8 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.9-week9/ title="Week 9 Worklog" class=dd-item><a href=../../1-worklog/1.9-week9/><b>1.9. </b>Week 9 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.10-week10/ title="Week 10 Worklog" class=dd-item><a href=../../1-worklog/1.10-week10/><b>1.10. </b>Week 10 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.11-week11/ title="Week 11 Worklog" class=dd-item><a href=../../1-worklog/1.11-week11/><b>1.11. </b>Week 11 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.12-week12/ title="Week 12 Worklog" class=dd-item><a href=../../1-worklog/1.12-week12/><b>1.12. </b>Week 12 Worklog
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/2-proposal/ title=Proposal class=dd-item><a href=../../2-proposal/><b>2. </b>Proposal
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/ title="Translated Blogs" class="dd-item
parent"><a href=../../3-blogstranslated/><b>3. </b>Translated Blogs
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/3-blogstranslated/3.1-blog1/ title="Blog 1" class=dd-item><a href=../../3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.2-blog2/ title="Blog 2" class=dd-item><a href=../../3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.3-blog3/ title="Blog 3" class="dd-item
active"><a href=../../3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/4-eventparticipated/ title="Events Participated" class=dd-item><a href=../../4-eventparticipated/><b>4. </b>Events Participated
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/4-eventparticipated/4.1-event1/ title="Event 1" class=dd-item><a href=../../4-eventparticipated/4.1-event1/><b>4.1. </b>Event 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.2-event2/ title="Event 2" class=dd-item><a href=../../4-eventparticipated/4.2-event2/><b>4.2. </b>Event 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.3-event3/ title="Event 3" class=dd-item><a href=../../4-eventparticipated/4.3-event3/><b>4.3. </b>Event 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.4-event4/ title="Event 4" class=dd-item><a href=../../4-eventparticipated/4.4-event4/><b>4.4. </b>Event 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.5-event5/ title="Event 5" class=dd-item><a href=../../4-eventparticipated/4.5-event5/><b>4.5. </b>Event 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.6-event6/ title="Event 6" class=dd-item><a href=../../4-eventparticipated/4.6-event6/><b>4.6. </b>Event 6
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/ title=Workshop class=dd-item><a href=../../5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.1-workshop-overview/ title=Introduction class=dd-item><a href=../../5-workshop/5.1-workshop-overview/><b>5.1. </b>Introduction
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.1-workshop-overview/5.1.1-whatisrag/ title="What is Retrieval-Augmented Generation (RAG)" class=dd-item><a href=../../5-workshop/5.1-workshop-overview/5.1.1-whatisrag/><b>5.1.1 </b>What is Retrieval-Augmented Generation (RAG)
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.1-workshop-overview/5.1.2-services/ title=Services class=dd-item><a href=../../5-workshop/5.1-workshop-overview/5.1.2-services/><b>5.1.2 </b>Services
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.2-prerequiste/ title=Prerequiste class=dd-item><a href=../../5-workshop/5.2-prerequiste/><b>5.2. </b>Prerequiste
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.2-prerequiste/5.2.1-model-access/ title="Verify Model Access" class=dd-item><a href=../../5-workshop/5.2-prerequiste/5.2.1-model-access/><b>5.2.1 </b>Verify Model Access
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.2-prerequiste/5.2.2-prepare-data/ title="Prepare source data" class=dd-item><a href=../../5-workshop/5.2-prerequiste/5.2.2-prepare-data/><b>5.2.2 </b>Prepare source data
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.3-knowledge-base/ title="Create and Configure Knowledge Base" class=dd-item><a href=../../5-workshop/5.3-knowledge-base/><b>5.3. </b>Create and Configure Knowledge Base
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.3-knowledge-base/5.3.1-create-kb/ title="Initialize Knowledge Base" class=dd-item><a href=../../5-workshop/5.3-knowledge-base/5.3.1-create-kb/><b>5.3.1 </b>Initialize Knowledge Base
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.3-knowledge-base/5.3.2-sync-data/ title="Check Vector Store and Data Synchronization" class=dd-item><a href=../../5-workshop/5.3-knowledge-base/5.3.2-sync-data/><b>5.3.2 </b>Check Vector Store and Data Synchronization
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.4-test-chatbox/ title="Testing Chatbot (RAG)" class=dd-item><a href=../../5-workshop/5.4-test-chatbox/><b>5.4. </b>Testing Chatbot (RAG)
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.5-client-integration/ title="Client Application Integration (Optional)" class=dd-item><a href=../../5-workshop/5.5-client-integration/><b>5.5. </b>Client Application Integration (Optional)
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.6-update-data/ title="Update data" class=dd-item><a href=../../5-workshop/5.6-update-data/><b>5.6. </b>Update data
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.7-cleanup/ title="Clean Resources" class=dd-item><a href=../../5-workshop/5.7-cleanup/><b>5.7. </b>Clean Resources
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/6-self-evaluation/ title=Self-Assessment class=dd-item><a href=../../6-self-evaluation/><b>6. </b>Self-Assessment
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/7-feedback/ title="Sharing and Feedback" class=dd-item><a href=../../7-feedback/><b>7. </b>Sharing and Feedback
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://pgmdes.github.io/fcj2025-workshop-minhtran/3-blogstranslated/3.3-blog3/ selected>English</option><option id=vi value=https://pgmdes.github.io/fcj2025-workshop-minhtran/vi/3-blogstranslated/3.3-blog3/>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../>Internship Report</a> > <a href=../../3-blogstranslated/>Translated Blogs</a> > Blog 3</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#solution-overview><strong>Solution Overview</strong></a></li><li><a href=#prerequisites><strong>Prerequisites</strong></a></li><li><a href=#set-up-infrastructure-with-aws-cloudformation><strong>Set Up Infrastructure with AWS CloudFormation</strong></a></li><li><a href=#upload-csv-to-s3-and-run-aws-glue-crawler><strong>Upload CSV to S3 and Run AWS Glue Crawler</strong></a></li><li><a href=#set-up-lake-formation-permissions><strong>Set Up Lake Formation Permissions</strong></a></li><li><a href=#configure-amazon-redshift-query-editor-v2><strong>Configure Amazon Redshift Query Editor v2</strong></a></li><li><a href=#set-up-schema-in-amazon-redshift><strong>Set Up Schema in Amazon Redshift</strong></a></li><li><a href=#create-a-view-in-amazon-redshift><strong>Create a View in Amazon Redshift</strong></a></li><li><a href=#create-local-database-user-for-arcgis-pro><strong>Create Local Database User for ArcGIS Pro</strong></a></li><li><a href=#connect-arcgis-pro-with-redshift-database><strong>Connect ArcGIS Pro with Redshift Database</strong></a></li><li><a href=#clean-up-resources><strong>Clean Up Resources</strong></a></li><li><a href=#conclusion><strong>Conclusion</strong></a></li><li><a href=#about-the-authors><strong>About the Authors</strong></a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 3</h1><h1 id=geospatial-data-lake-with-amazon-redshift><strong>Geospatial Data Lake with Amazon Redshift</strong></h1><p><em>By Jeremy Spell and Jeff DeMuth | July 10, 2025 | Related to <a href=https://aws.amazon.com/blogs/big-data/category/analytics/amazon-redshift-analytics/>Amazon Redshift</a>, <a href=https://aws.amazon.com/blogs/big-data/category/analytics/aws-glue/>AWS Glue</a>, <a href=https://aws.amazon.com/blogs/big-data/category/analytics/aws-lake-formation/>AWS Lake Formation</a>, <a href=https://aws.amazon.com/blogs/big-data/category/post-types/technical-how-to/>Technical How-to</a></em></p><p>Data lake architecture helps organizations move data away from expensive storage systems while maintaining query and analysis capabilities. This approach is useful for geospatial data, where builders can have terabytes of infrequently accessed data in databases that need to maintain cost efficiency. However, this requires data lake query tools that support data types and functions of geographic information systems (GIS).</p><p><a href=https://aws.amazon.com/redshift/>Amazon Redshift</a> supports <a href=https://docs.aws.amazon.com/redshift/latest/dg/geospatial-overview.html>geospatial data</a> queries, including GEOMETRY and GEOGRAPHY types and functions used in GIS system queries. Additionally, Amazon Redshift allows you to query geospatial data both in data lakes on Amazon S3 and in Redshift data warehouses, giving you flexibility in data access methods. Moreover, <a href=https://aws.amazon.com/lake-formation/>AWS Lake Formation</a> and <a href=https://aws.amazon.com/iam/>AWS Identity and Access Management</a> (IAM) support in Esri&rsquo;s <a href=https://www.esri.com/en-us/arcgis/products/arcgis-pro/overview>ArcGIS Pro</a> provide a secure way to connect between geospatial data lakes and map visualization tools. You can set up, manage, and secure geospatial data lakes in the cloud with just a few clicks.</p><p>In this article, we guide you through setting up a geospatial data lake using Lake Formation and querying data with ArcGIS Pro via <a href=https://aws.amazon.com/redshift/redshift-serverless/>Amazon Redshift Serverless</a>.</p><h2 id=solution-overview><strong>Solution Overview</strong></h2><p>In the example, a county health department uses Lake Formation to protect a data lake containing Protected Health Information (PHI) data. Epidemiologists want to create maps of clinics that provide vaccinations to the community. The county&rsquo;s GIS analysts need data lake access to create required maps but should not be allowed to access PHI data.</p><p>The solution uses Lake Formation tags to enable column-level access permissions in the database for public information including clinic name, address, zip code, and latitude/longitude coordinates, while denying access to PHI data in the same table. We use Redshift Serverless and <a href=https://docs.aws.amazon.com/redshift/latest/dg/c-getting-started-using-spectrum.html>Amazon Redshift Spectrum</a> to access this data from ArcGIS Pro, Esri&rsquo;s GIS mapping software, an AWS partner.</p><p><img alt=image1 src=../../images/3-BlogsTranslated/16.png></p><p>Below is the sample schema for this article.</p><table><thead><tr><th style=text-align:left>Description</th><th style=text-align:left>Column Name</th><th style=text-align:left>Geoproperty Tag</th></tr></thead><tbody><tr><td style=text-align:left>Patient ID</td><td style=text-align:left>patient_id</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>Clinic ID</td><td style=text-align:left>clinic_id</td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:left>Clinic Address</td><td style=text-align:left>clinic_address</td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:left>Clinic ZIP Code</td><td style=text-align:left>clinic_zip</td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:left>Clinic City</td><td style=text-align:left>clinic_city</td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:left>Patient First Name</td><td style=text-align:left>first_name</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>Patient Last Name</td><td style=text-align:left>last_name</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>Patient Address</td><td style=text-align:left>patient_address</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>Patient ZIP Code</td><td style=text-align:left>patient_zip</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>Vaccination Type</td><td style=text-align:left>vaccination_type</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>Clinic Latitude</td><td style=text-align:left>clinic_lat</td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:left>Clinic Longitude</td><td style=text-align:left>clinic_long</td><td style=text-align:left>Yes</td></tr></tbody></table><p>Solution setup steps:</p><ol><li>Deploy infrastructure using <a href=http://aws.amazon.com/cloudformation>AWS CloudFormation</a>.</li><li>Upload a CSV with sample data to an <a href=http://aws.amazon.com/s3>Amazon S3</a> bucket and run an <a href=https://aws.amazon.com/glue>AWS Glue</a> crawler to discover data.</li><li>Set up Lake Formation permissions.</li><li>Configure Amazon Redshift Query Editor v2.</li><li>Set up schema in Amazon Redshift.</li><li>Create a view in Amazon Redshift.</li><li>Create a local database user in ArcGIS Pro.</li><li>Connect ArcGIS Pro with Redshift database.</li></ol><h2 id=prerequisites><strong>Prerequisites</strong></h2><p>You need:</p><ul><li>AWS Account</li><li><a href=https://docs.aws.amazon.com/lake-formation/latest/dg/initial-lf-config.html>Lake Formation enabled in target AWS Region</a></li><li>Understanding of Lake Formation and table permission setup</li><li><a href=https://pro.arcgis.com/en/pro-app/latest/get-started/install-and-sign-in-to-arcgis-pro.htm>ArcGIS Pro</a></li><li>Network connectivity from ArcGIS Pro client to VPC where Amazon Redshift resources are deployed via <a href=https://docs.aws.amazon.com/vpn/latest/clientvpn-admin/what-is.html>VPN</a> or <a href=https://aws.amazon.com/directconnect/>AWS Direct Connect</a></li></ul><h2 id=set-up-infrastructure-with-aws-cloudformation><strong>Set Up Infrastructure with AWS CloudFormation</strong></h2><p>To create the demo environment, follow these steps:</p><ul><li>Sign in to the <a href=http://aws.amazon.com/console>AWS Management Console</a> with an AWS administrator account and Lake Formation data lake administrator account—this account needs to be both account admin and data lake admin for the template to complete.</li><li>Open the AWS CloudFormation console</li><li>Select <a href="https://us-east-1.console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/create?stackName=geo-sample&templateURL=https://aws-blogs-artifacts-public.s3.amazonaws.com/BDB-3975/infra_setup.yml">Launch Stack</a>.</li></ul><p>The CloudFormation template creates the following components:</p><ul><li>S3 bucket – <code>samp-clinic-db-{ACCOUNT\_ID}</code></li><li>AWS Glue database – <code>samp-clinical-glue-db</code></li><li>AWS Glue crawler – <code>samp-glue-crawler</code></li><li>Redshift Serverless workgroup – <code>samp-clinical-rs-wg</code></li><li>Redshift Serverless namespace – <code>samp-clinical-rs-ns</code></li><li>IAM role for Amazon Redshift – <code>demo-RedshiftIAMRole-{UNIQUE\_ID}</code></li><li>IAM role for AWS Glue – <code>samp-clinical-glue-role</code></li><li>Lake Formation tag – <code>geoproperty</code></li></ul><h2 id=upload-csv-to-s3-and-run-aws-glue-crawler><strong>Upload CSV to S3 and Run AWS Glue Crawler</strong></h2><p>Next, create a data lake in the demo environment, then use AWS Glue crawler to populate the AWS Glue database and update schema and metadata in the AWS Glue Data Catalog.</p><p>The CloudFormation stack already created S3 bucket, AWS Glue database, and crawler. We provide a fictional sample dataset representing patient and clinic information. Download the file and follow these steps:</p><ol><li>On the AWS CloudFormation console, open the stack you just launched.</li><li>On the Resources tab, select the link to the S3 bucket.</li><li>Select Upload and upload the CSV file (data-with-geocode.csv), then select Upload.</li><li>On the AWS Glue console, select Crawlers in the navigation.</li><li>Select the crawler you created with the stack and click Run.
The crawler runs for about one minute and populates a table named <code>clinic-sample-s3\_ACCOUNT\_ID</code> with sample data.</li><li>Select Tables in the navigation and open the table created by the crawler.</li></ol><p>You&rsquo;ll see the dataset contains PHI and personally identifiable information (PII) fields.</p><p><img alt=image2 src=../../images/3-BlogsTranslated/17.png></p><p>Now we have a database and Data Catalog populated with schema and metadata for the rest of the process.</p><h2 id=set-up-lake-formation-permissions><strong>Set Up Lake Formation Permissions</strong></h2><p>Next, we demonstrate how to protect PHI data for compliance while still supporting GIS analysts to work effectively. To protect the data lake, use AWS Lake Formation. To set up Lake Formation permissions correctly, you need to understand how data lake access is configured.</p><p>The Data Catalog provides metadata and schema that allow services to access data in the lake. To access the data lake from ArcGIS Pro, use the <a href=https://pro.arcgis.com/en/pro-app/latest/help/data/databases/connect-redshift.htm>ArcGIS Pro Redshift</a> connector, which allows connections from ArcGIS Pro to Amazon Redshift. Amazon Redshift can access the Data Catalog and provide connections to the data lake. The CloudFormation template already created a Redshift Serverless instance and namespace with an IAM role to configure this connection. We still need to set up Lake Formation permissions so GIS analysts only access public fields, not fields containing PHI or PII. We&rsquo;ll assign Lake Formation tags to columns containing public information and assign permissions to GIS analysts to access columns with these tags.</p><p>By default, Lake Formation is configured with Super access to <code>IAMAllowedPrinciples</code>; this is for backward compatibility as noted in <a href=https://docs.aws.amazon.com/lake-formation/latest/dg/change-settings.html>changing default settings for data lake</a>. To demonstrate more secure configuration, we&rsquo;ll remove this default setting.</p><ol><li>On the Lake Formation console, select <strong>Administration</strong> in the navigation.</li><li>Under <strong>Data Catalog settings</strong>, ensure <strong>Use only IAM access control for new databases</strong> and <strong>Use only IAM access control for new tables in new databases</strong> are not selected.
<img alt=image3 src=../../images/3-BlogsTranslated/18.png></li><li>In the navigation, under <strong>Permissions</strong>, select <strong>Data permissions</strong>.</li><li>Select <code>IAMAllowedPrincipals</code> and click Revoke.</li><li>Select <strong>Tables</strong> in the navigation.</li><li>Open table <code>clinic-sample-s3\_ACCOUNT\_ID</code> and select <strong>Edit schema</strong>.</li><li>Select fields starting with clinic_ and select <strong>Edit LF-Tags</strong>.</li><li>The CloudFormation stack created a Lake Formation tag named <code>geoproperty</code>. Assign <code>geoproperty</code> as key and true as value for all <code>clinic_</code> fields, then select <strong>Save</strong>.
Next, grant permissions to the Amazon Redshift IAM role to access fields tagged with <code>geoproperty = true</code>.</li><li>Select <strong>Data lake permissions</strong>, then select <strong>Grant</strong>.</li><li>For IAM role, select <code>demo-RedshiftIAMRole-UNIQUE_ID</code>.</li><li>Select <code>geoproperty</code> for key and true for value.</li><li>In <strong>Database permissions</strong>, select <strong>Describe</strong>, and in <strong>Table permissions</strong>, select <strong>Select</strong> and <strong>Describe</strong>.</li></ol><h2 id=configure-amazon-redshift-query-editor-v2><strong>Configure Amazon Redshift Query Editor v2</strong></h2><p>Next, configure the initial Amazon Redshift setup necessary for database operations. We use an <a href=https://aws.amazon.com/secrets-manager/>AWS Secrets Manager</a> secret created by the template to manage passwords securely following AWS best practices.</p><ol><li>On the Amazon Redshift console, select <strong>Query editor v2</strong>.</li><li>On first launch, Amazon Redshift will show one-time configuration for the account. For this article, keep defaults and select <strong>Configure account</strong>.</li></ol><p>See additional options at <a href=https://docs.aws.amazon.com/redshift/latest/mgmt/query-editor-v2-getting-started.html>Configuring your AWS account</a>.</p><p><img alt=image4 src=../../images/3-BlogsTranslated/19.png></p><p>The query editor needs credentials to connect to the serverless instance; this information was created by the template and stored in Secrets Manager.</p><ol start=3><li>Select <strong>Other ways to connect</strong>, then select <strong>AWS Secrets Manager</strong>.</li><li>Under <strong>Secret</strong>, select (<code>Redshift-admin-credentials</code>).</li><li>Select <strong>Save</strong>.
<img alt=image5 src=../../images/3-BlogsTranslated/20.png></li></ol><h2 id=set-up-schema-in-amazon-redshift><strong>Set Up Schema in Amazon Redshift</strong></h2><p>External schema in Amazon Redshift is a feature that references schema existing at external data sources. See <a href=https://docs.aws.amazon.com/redshift/latest/dg/c-spectrum-external-schemas.html>External schemas in Amazon Redshift Spectrum</a> for creating external schema. We use external schema to provide access to the data lake within Amazon Redshift. From ArcGIS Pro, we&rsquo;ll connect to Amazon Redshift to access geospatial data.</p><p>The IAM role used when creating external schema must be associated with the Redshift namespace. The template already set this up, but you should verify before proceeding.</p><ol><li>In the Redshift Serverless console, select <strong>Namespace configuration</strong> in the navigation pane.</li><li>Select namespace (<code>sample-rs-namespace</code>).
<img alt=image6 src=../../images/3-BlogsTranslated/21.png>
On the <strong>Security and encryption</strong> tab, you&rsquo;ll see the IAM role created by CloudFormation. If the role or namespace doesn&rsquo;t exist, check the stack in AWS CloudFormation before proceeding.</li><li>Copy the ARN of the role for later use.
<img alt=image7 src=../../images/3-BlogsTranslated/22.png></li><li>Select <strong>Query data</strong> to return to the query editor.</li></ol><p><img alt=image8 src=../../images/3-BlogsTranslated/23.png></p><ol start=5><li>In the query editor, enter the following SQL command; remember to replace the example ARN with yours. This SQL command creates an external schema using the same Redshift role attached to the namespace to link to the AWS Glue database.</li></ol><pre tabindex=0><code>CREATE EXTERNAL SCHEMA samp_clinic_sch_ext FROM DATA CATALOG
database &#39;sample-glue-database&#39;
IAM_ROLE &#39;arn:aws:iam::{ACCOUNT_ID}:role/demo-RedshiftIAMRole-{UNIQUE_ID}&#39;;
</code></pre><ol start=6><li><p>In the query editor, execute a select query on <code>sample-glue-database</code></p><pre tabindex=0><code>SELECT * FROM &#34;dev&#34;.&#34;samp_clinic_sch_ext&#34;.&#34;clinic-sample_s3_{ACCOUNT_ID}&#34;;
</code></pre><p>Because the associated role has been granted access to columns tagged with <code>geoproperty = true</code>, only these fields will be returned, as shown in the following image (sample data is fictional).
<img alt=image9 src=../../images/3-BlogsTranslated/24.png></p></li><li><p>Use the following command to create a local schema in Amazon Redshift. External schema cannot be updated; we&rsquo;ll use local schema to add geometry fields using Redshift functions.</p><pre tabindex=0><code>CREATE SCHEMA samp_clinic_sch_local
</code></pre></li></ol><h2 id=create-a-view-in-amazon-redshift><strong>Create a View in Amazon Redshift</strong></h2><p>For data to display from ArcGIS Pro, we need to create a view. After schema setup, we create a view that can be accessed from ArcGIS Pro.</p><p>Amazon Redshift provides many <a href=https://docs.aws.amazon.com/redshift/latest/dg/geospatial-functions.html>geospatial functions</a> used to create views with fields that ArcGIS Pro uses to add points to maps. We&rsquo;ll use one function since the dataset has latitude and longitude.</p><p>Use the following SQL command in Amazon Redshift Query Editor to create a view named <code>clinic_location_view</code>. Replace <code>{ACCOUNT_ID}</code> with your account ID.</p><pre tabindex=0><code>CREATE OR REPLACE VIEW &#34;samp_clinic_sch_local&#34;.&#34;clinic_location_view&#34; AS
SELECT
    clinic_id as id,
    clinic_lat as lat,
    clinic_long as long,
    ST_MAKEPOINT(long, lat) as geom
FROM
    &#34;dev&#34;.&#34;samp_clinic_sch_ext&#34;.&#34;clinic-sample_s3_{ACCOUNT_ID}&#34;
WITH NO SCHEMA BINDING;
</code></pre><p>The new view in the local schema will have a geom column containing map points used by ArcGIS Pro to add points when creating maps. The points in this example are clinic locations providing vaccinations. In practice, when new clinics are built and new data is added to the data lake, their locations will appear on maps using this data.</p><h2 id=create-local-database-user-for-arcgis-pro><strong>Create Local Database User for ArcGIS Pro</strong></h2><p>In the demo, we use a database user and group to grant permissions to the ArcGIS Pro client. Enter the following SQL in Amazon Redshift Query Editor to create the user and group:</p><pre tabindex=0><code>CREATE USER dbuser with PASSWORD &#39;SET_PASSWORD_HERE&#39;;
CREATE GROUP esri_developer_group;
ALTER GROUP esri_developer_group ADD USER dbuser;
</code></pre><p>After running this, use the following commands to grant permissions to the group:</p><pre tabindex=0><code>GRANT USAGE ON SCHEMA samp_clinic_sch_local TO GROUP esri_developer_group;
ALTER DEFAULT PRIVILEGES IN SCHEMA samp_clinic_sch_local GRANT SELECT ON TABLES TO GROUP esri_developer_group;
GRANT SELECT ON ALL TABLES IN SCHEMA samp_clinic_sch_local TO GROUP esri_developer_group;
</code></pre><h2 id=connect-arcgis-pro-with-redshift-database><strong>Connect ArcGIS Pro with Redshift Database</strong></h2><p>To add database connections to ArcGIS Pro, you need the endpoint for your Redshift Serverless workgroup. You can view endpoint information on the detail page of workgroup <code>sample-rs-wg</code> on the Redshift Serverless console. The Redshift namespace and workgroup are listed by default, as shown in the image below.</p><p><img alt=image10 src=../../images/3-BlogsTranslated/25.png></p><p>You can copy the endpoint in the <strong>General information</strong> section. This endpoint needs to be modified; the <code>:5439/dev</code> portion needs to be removed when configuring the connector in ArcGIS Pro.</p><p><img alt=image11 src=../../images/3-BlogsTranslated/26.png></p><ol><li>Open ArcGIS Pro with the project where you want to add the Redshift connection.</li></ol><table><thead><tr><th style=text-align:left>Ensure you&rsquo;ve installed the <a href=https://docs.aws.amazon.com/redshift/latest/mgmt/odbc20-install-config-win.html>Amazon Redshift ODBC connector</a>; this is required to connect.</th></tr></thead><tbody></tbody></table><ol start=2><li>On the menu, select <strong>Insert</strong> then <strong>Connections</strong>, <strong>Database</strong>, and <strong>New Database Connection</strong>.</li><li>Under <strong>Database Platform</strong>, select <strong>Amazon Redshift</strong>.</li><li>Under <strong>Server</strong>, paste the copied endpoint (remove everything after .com from the endpoint).</li><li>Under <strong>Database</strong>, select your database.
<img alt=image12 src=../../images/3-BlogsTranslated/27.png></li></ol><p>If your ArcGIS Pro client cannot access the endpoint, you&rsquo;ll get an error at this step. A network path must exist between the ArcGIS Pro client and the Redshift Serverless endpoint. You can establish the network path with <a href=https://docs.aws.amazon.com/whitepapers/latest/aws-vpc-connectivity-options/aws-direct-connect.html>Direct Connect</a>, <a href=https://docs.aws.amazon.com/vpn/latest/s2svpn/VPC_VPN.html>AWS Site-to-Site VPN</a>, or <a href=https://docs.aws.amazon.com/vpn/latest/clientvpn-admin/what-is.html>AWS Client VPN</a>. While not recommended for security reasons, you can also <a href=https://docs.aws.amazon.com/redshift/latest/mgmt/serverless-console-workgroups.html#serverless-workgroup-describe>configure a public endpoint</a> for Amazon Redshift. Consult your network security team for best practices before allowing public access to Redshift Serverless.</p><p>If you have network connectivity but still get connection errors, check the security group to allow inbound from the ArcGIS Pro subnet over the port Redshift Serverless uses. The default is 5439, but port ranges can be configured depending on your environment; see <a href=https://docs.aws.amazon.com/redshift/latest/mgmt/serverless-connecting.html>Connecting to Amazon Redshift Serverless</a> for more information.</p><p>If the connection is successful, ArcGIS Pro will add the Amazon Redshift connection under <strong>Connection File Name</strong>.</p><ol><li>Select <strong>OK</strong>.</li><li>Select the connection to display the created view with geometry (<code>clinic_location_view</code>).</li><li>Right-click the view and select <strong>Add To Current Map</strong>.</li></ol><p>ArcGIS Pro will add the points from the view to the map. The final map was edited to use red crosshair symbols representing clinics instead of circles.</p><p><img alt=image13 src=../../images/3-BlogsTranslated/28.png></p><h2 id=clean-up-resources><strong>Clean Up Resources</strong></h2><p>After completing the demo, follow these steps:</p><ol><li>In the Amazon S3 console, open the bucket created by the CloudFormation stack and delete the <code>data-with-geocode.csv</code> file.</li><li>In the AWS CloudFormation console, delete the demo stack to remove created resources.</li></ol><h2 id=conclusion><strong>Conclusion</strong></h2><p>This article has guided you through setting up Redshift Serverless to use geospatial data in your data lake to enhance maps in ArcGIS Pro. This technique helps builders and GIS analysts leverage existing datasets in the data lake and transform them in Amazon Redshift to enrich data before presenting it on maps. We also showed how to protect your data lake using Lake Formation, discover geospatial datasets with AWS Glue, and visualize data in ArcGIS Pro.</p><p>For more best practices on storing geospatial data in Amazon S3 and querying with Amazon Redshift, see <a href=https://aws.amazon.com/blogs/publicsector/how-partition-geospatial-data-lake-analysis-amazon-redshift/>How to partition your geospatial data lake for analysis with Amazon Redshift</a>. We welcome your feedback in the comments section.</p><h2 id=about-the-authors><strong>About the Authors</strong></h2><p><img alt=image14 src=../../images/3-BlogsTranslated/29.jpg> <strong>Jeremy Spell</strong> is a cloud infrastructure architect working at AWS Professional Services. He enjoys designing and building solutions for customers. In his spare time, Jeremy enjoys making Texas-style BBQ and spending time with family and church community.</p><p><img alt=image15 src=../../images/3-BlogsTranslated/30.jpg> <strong>Jeff Demuth</strong> is a solutions architect who joined AWS in 2016. He focuses on the geospatial community and is passionate about Geographic Information Systems (GIS) and technology. Outside of work, Jeff enjoys traveling, building IoT applications, and tinkering with new gadgets.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../3-blogstranslated/3.2-blog2/ title="Blog 2"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../4-eventparticipated/ title="Events Participated" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../js/clipboard.min.js?1765363205></script><script src=../../js/perfect-scrollbar.min.js?1765363205></script><script src=../../js/perfect-scrollbar.jquery.min.js?1765363205></script><script src=../../js/jquery.sticky.js?1765363205></script><script src=../../js/featherlight.min.js?1765363205></script><script src=../../js/highlight.pack.js?1765363205></script><script>hljs.initHighlightingOnLoad()</script><script src=../../js/modernizr.custom-3.6.0.js?1765363205></script><script src=../../js/learn.js?1765363205></script><script src=../../js/hugo-learn.js?1765363205></script><link href=../../mermaid/mermaid.css?1765363205 rel=stylesheet><script src=../../mermaid/mermaid.js?1765363205></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>